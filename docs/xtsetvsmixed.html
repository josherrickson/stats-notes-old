<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Josh Errickson">

<title>Statistics Notes - Stata’s mixed versus xtreg</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Statistics Notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-topics" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">R Topics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r-topics">    
        <li>
    <a class="dropdown-item" href="./responsesurfaceplot.html" rel="" target="">
 <span class="dropdown-text">Response Surface Plot</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-stata-topics" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Stata Topics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-stata-topics">    
        <li>
    <a class="dropdown-item" href="./svy_gsem_teffects.html" rel="" target="">
 <span class="dropdown-text">Mediation with svyset data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./logitinterpretation.html" rel="" target="">
 <span class="dropdown-text">Logistic Models and the Margins Command</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./xtsetvsmixed.html" rel="" target="">
 <span class="dropdown-text">Stata’s mixed versus xtreg</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-statistical-topics" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Statistical Topics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-statistical-topics">    
        <li>
    <a class="dropdown-item" href="./splinesvsinteraction.html" rel="" target="">
 <span class="dropdown-text">Splines vs Interaction models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./randomselection.html" rel="" target="">
 <span class="dropdown-text">Choosing a Random Sample</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./iccirr.html" rel="" target="">
 <span class="dropdown-text">Inter-rater Reliability</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./divideby4.html" rel="" target="">
 <span class="dropdown-text">The "Divide by 4" Rule</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Back to list</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data" id="toc-data" class="nav-link active" data-scroll-target="#data">Data</a></li>
  <li><a href="#theory" id="toc-theory" class="nav-link" data-scroll-target="#theory">Theory</a>
  <ul class="collapse">
  <li><a href="#the-math" id="toc-the-math" class="nav-link" data-scroll-target="#the-math">The Math</a></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions">Assumptions</a></li>
  </ul></li>
  <li><a href="#xtsum-estimating-betweenwithinoverall-variance" id="toc-xtsum-estimating-betweenwithinoverall-variance" class="nav-link" data-scroll-target="#xtsum-estimating-betweenwithinoverall-variance"><code>xtsum</code>: Estimating between/within/overall variance</a>
  <ul class="collapse">
  <li><a href="#overall-variation" id="toc-overall-variation" class="nav-link" data-scroll-target="#overall-variation">Overall variation</a></li>
  <li><a href="#within-variation" id="toc-within-variation" class="nav-link" data-scroll-target="#within-variation">Within variation</a></li>
  <li><a href="#between-variation" id="toc-between-variation" class="nav-link" data-scroll-target="#between-variation">Between variation</a></li>
  </ul></li>
  <li><a href="#fitting-the-models" id="toc-fitting-the-models" class="nav-link" data-scroll-target="#fitting-the-models">Fitting the models</a>
  <ul class="collapse">
  <li><a href="#xtreg-fe-fixed-effect-model-within-variance" id="toc-xtreg-fe-fixed-effect-model-within-variance" class="nav-link" data-scroll-target="#xtreg-fe-fixed-effect-model-within-variance"><code>xtreg, fe</code>: Fixed Effect model (Within variance)</a></li>
  <li><a href="#xtreg-be-between-effect-model-between-variance" id="toc-xtreg-be-between-effect-model-between-variance" class="nav-link" data-scroll-target="#xtreg-be-between-effect-model-between-variance"><code>xtreg, be</code>: Between Effect model (Between variance)</a></li>
  <li><a href="#xtreg-re-random-effect-model-both-variances" id="toc-xtreg-re-random-effect-model-both-variances" class="nav-link" data-scroll-target="#xtreg-re-random-effect-model-both-variances"><code>xtreg, re</code>: Random Effect model (Both variances)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Stata’s mixed versus xtreg</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Josh Errickson </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>In Stata, panel data (repeated measures) can be modeled using <code>mixed</code> (and its siblings e.g.&nbsp;<code>melogit</code>, <code>mepoisson</code>) or using the <code>xt</code> toolkit, including <code>xtset</code> and <code>xtreg</code>.</p>
<p>This document is an attempt to show the equivalency of the models between the two commands. There will be slight differences due to the algorithms used in the backend but the results should generally be equivalent.</p>
<section id="data" class="level1">
<h1>Data</h1>
<p>We’ll use the “nlswork” data:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">webuse</span> nlswork, <span class="kw">clear</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>(National Longitudinal Survey <span class="kw">of</span> Young Women, 14-24 years old <span class="kw">in</span> 1968)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>. <span class="kw">desc</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Contains <span class="kw">data</span> from https:<span class="co">//www.stata-press.com/data/r18/nlswork.dta</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a> Observations:        28,534                  National Longitudinal Survey <span class="kw">of</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                                                Young Women, 14-24 years old <span class="kw">in</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                                                1968</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    Variables:            21                  27 Nov 2022 08:14</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                                              (<span class="dt">_dta</span> has <span class="kw">notes</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>-------------------------------------------------------------------------------</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>Variable      Storage   Display    Value</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="bn">name</span>         <span class="dv">type</span>    <span class="kw">format</span>    <span class="kw">label</span>      Variable <span class="kw">label</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>-------------------------------------------------------------------------------</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>idcode          <span class="kw">int</span>     %8.0g                 NLS ID</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">year</span>            <span class="kw">byte</span>    %8.0g                 Interview <span class="fu">year</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>birth_yr        <span class="kw">byte</span>    %8.0g                 Birth <span class="fu">year</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>age             <span class="kw">byte</span>    %8.0g                 Age <span class="kw">in</span> current <span class="fu">year</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>race            <span class="kw">byte</span>    %8.0g      racelbl    Race</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>msp             <span class="kw">byte</span>    %8.0g                 1 <span class="kw">if</span> married, spouse present</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>nev_mar         <span class="kw">byte</span>    %8.0g                 1 <span class="kw">if</span> never married</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>grade           <span class="kw">byte</span>    %8.0g                 Current grade completed</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>collgrad        <span class="kw">byte</span>    %8.0g                 1 <span class="kw">if</span> college graduate</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>not_smsa        <span class="kw">byte</span>    %8.0g                 1 <span class="kw">if</span> <span class="kw">not</span> SMSA</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>c_city          <span class="kw">byte</span>    %8.0g                 1 <span class="kw">if</span> central city</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>south           <span class="kw">byte</span>    %8.0g                 1 <span class="kw">if</span> south</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>ind_code        <span class="kw">byte</span>    %8.0g                 Industry <span class="kw">of</span> employment</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>occ_code        <span class="kw">byte</span>    %8.0g                 Occupation</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="kw">union</span>           <span class="kw">byte</span>    %8.0g                 1 <span class="kw">if</span> <span class="kw">union</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>wks_ue          <span class="kw">byte</span>    %8.0g                 Weeks unemployed <span class="fu">last</span> <span class="fu">year</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>ttl_exp         <span class="kw">float</span>   %9.0g                 Total work experience</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>tenure          <span class="kw">float</span>   %9.0g                 Job tenure, <span class="kw">in</span> years</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>hours           <span class="kw">int</span>     %8.0g                 Usual hours worked</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>wks_work        <span class="kw">int</span>     %8.0g                 Weeks worked <span class="fu">last</span> <span class="fu">year</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>ln_wage         <span class="kw">float</span>   %9.0g                 <span class="fu">ln</span>(wage/GNP deflator)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>-------------------------------------------------------------------------------</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>Sorted <span class="kw">by</span>: idcode  <span class="fu">year</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>idcode</code> represents each individual, data is measured over the years. Lets set it up using <code>xtset</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>. xtset idcode</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Panel <span class="kw">variable</span>: idcode (unbalanced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="theory" class="level1">
<h1>Theory</h1>
<p>Within the panel/<code>xt</code> framework, there are three separate models:</p>
<ul>
<li><code>fe</code> or “fixed effects”. This is modeling the within variation - Ignoring differences between individuals, is there a difference per values of time-varying variables?</li>
<li><code>be</code> or “between effects”. This is modeling the between variation - Averaging across individuals (collapsing over time), is there a difference per values of subject-varying variables?</li>
<li><code>re</code> or “random effects”. This generates a weighted average of the above two models.</li>
</ul>
<p>Each is fitted via</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">xtreg</span> &lt;<span class="kw">model</span>&gt;, <span class="kw">fe</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">xtreg</span> &lt;<span class="kw">model</span>&gt;, <span class="kw">be</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">xtreg</span> &lt;<span class="kw">model</span>&gt;, re</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The short version of how to fit each model using <code>mixed</code> is:</p>
<ul>
<li><code>fe</code>: Run a linear model with <code>reg</code> including the group as a categorical variable (this is called the Least Squares Dummy Variable, LSDV, model).</li>
<li><code>be</code>: Collapse over individual, and run a linear model with <code>reg</code>.</li>
<li><code>re</code>: A traditional mixed model with a random effect (this is random effect in the sense of a mixed model, not in the <code>xt</code> setting) for individual.</li>
</ul>
<section id="the-math" class="level2">
<h2 class="anchored" data-anchor-id="the-math">The Math</h2>
<p>Picture a typical mixed model setup:</p>
<p><span class="math display">\[
    y\_{it} = \alpha + x\_{it}\beta + \nu\_i + \epsilon\_{it}.
\]</span></p>
<p>Here <span class="math inline">\(i\)</span> is an index for individuals, <span class="math inline">\(t\)</span> is an index for time. <span class="math inline">\(y\_{it}\)</span> and <span class="math inline">\(x\_{it}\)</span> are some outcome and predictor which are both time and individual varying. <span class="math inline">\(\nu\_{i}\)</span> is an error associated with each individual and <span class="math inline">\(\epsilon\_{it}\)</span> is an additional error per observation.</p>
<p>If this model is true, then the following must be true:</p>
<p><span class="math display">\[
    \overline{y}\_i = \alpha + \overline{x}\_i\beta + \nu\_i + \overline{\epsilon\_i}.
\]</span></p>
<p>Each bar’d variable is average over each individual. In this model, <span class="math inline">\(\nu\_i\)</span> and <span class="math inline">\(\overline{\epsilon}\_i\)</span> are indistinguishable, so this is just a linear model.</p>
<p>Since we have that both models are equivalent, if we difference them, we remain equivalent:</p>
<p><span class="math display">\[
    (y\_{it} - \overline{y}\_i) = (x\_{it} - \overline{x}\_i)\beta + (\epsilon\_{it} - \overline{\epsilon}\_i).
\]</span></p>
<p>Again, we have just a linear model.</p>
<p>Finally, the random effects model doesn’t add much clarity, but it essentially is a weighted combination of the other two, with the weight being a function of the variance of <span class="math inline">\(\nu\_i\)</span> and <span class="math inline">\(\epsilon\_i\)</span>. If the variance of <span class="math inline">\(\nu\_i\)</span> is 0, then there’s no individual level effect and the first model can be fit lineally (because <span class="math inline">\(\nu\_i\)</span> is constant and folds into the intercept).</p>
</section>
<section id="assumptions" class="level2">
<h2 class="anchored" data-anchor-id="assumptions">Assumptions</h2>
<p>There is one key different assumption between the models:</p>
<p>The random effects model assumes that unobservable variables are uncorrelated with other covariates. The other models don’t.</p>
<p>The between effects and random effects models assume that <span class="math inline">\(\nu\_i\)</span> and <span class="math inline">\(\overline{x}\_i\)</span> are uncorrelated (individual intercepts are independent of predictors).</p>
</section>
</section>
<section id="xtsum-estimating-betweenwithinoverall-variance" class="level1">
<h1><code>xtsum</code>: Estimating between/within/overall variance</h1>
<p>The <code>xtsum</code> command can be used to estimate the variance of a variable within versus between.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">xtsum</span> ln_wage</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>Variable         |      Mean   Std. <span class="kw">dev</span>.       Min        Max |    Observations</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>-----------------+--------------------------------------------+----------------</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ln_wage  overall |  1.674907   .4780935          0   5.263916 |     <span class="kw">N</span> =   28534</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         between |              .424569          0   3.912023 |     n =    4711</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>         within  |               .29266  -.4077221    4.78367 | T-<span class="bn">bar</span> = 6.05689</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We can replicate all these results without <code>xt</code>. As a sidenote, “T-bar” represents the average number of measures per individual, or <code>N/n</code>.</p>
<section id="overall-variation" class="level2">
<h2 class="anchored" data-anchor-id="overall-variation">Overall variation</h2>
<p>Easy:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>. summ ln_wage</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    Variable |        Obs        Mean    Std. <span class="kw">dev</span>.       Min        Max</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>-------------+---------------------------------------------------------</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>     ln_wage |     28,534    1.674907    .4780935          0   5.263916</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="within-variation" class="level2">
<h2 class="anchored" data-anchor-id="within-variation">Within variation</h2>
<p>Taking our cue from the notes in <a href="#the-theory">the theory</a>, to obtain within variation we will center the variable by individual.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">egen</span> meanln_wage = <span class="kw">mean</span>(ln_wage), <span class="kw">by</span>(idcode)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> cln_wage = ln_wage - meanln_wage</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>. summ cln_wage</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    Variable |        Obs        Mean    Std. <span class="kw">dev</span>.       Min        Max</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>-------------+---------------------------------------------------------</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    cln_wage |     28,534   -2.83e-10      .29266  -2.082629   3.108763</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that the mean is 0 (within rounding error), as we’d expect. To get the mean/min/max back into the same scale as the raw data we can re-add the overall mean to</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">egen</span> overallmean = <span class="kw">mean</span>(ln_wage)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> cln_wage2 = cln_wage + overallmean</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>. summ cln_wage2</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    Variable |        Obs        Mean    Std. <span class="kw">dev</span>.       Min        Max</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>-------------+---------------------------------------------------------</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>   cln_wage2 |     28,534    1.674907      .29266  -.4077221   4.783669</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This works because each individual has mean of 0 or in the second case, <code>overallmean</code>, in either case, since the means are constant, we’ve removed any between variance and isolated the within variance.</p>
</section>
<section id="between-variation" class="level2">
<h2 class="anchored" data-anchor-id="between-variation">Between variation</h2>
<p>We simply collapse by id.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">preserve</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>. <span class="kw">collapse</span> (<span class="kw">mean</span>) ln_wage, <span class="kw">by</span>(idcode)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>. summ ln_wage</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    Variable |        Obs        Mean    Std. <span class="kw">dev</span>.       Min        Max</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>-------------+---------------------------------------------------------</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>     ln_wage |      4,711    1.650605     .424569          0   3.912023</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>. <span class="kw">restore</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Doing this works because each subject now has a single observation, hence the within variance is identically 0, so the remaining variance is between-variance.</p>
</section>
</section>
<section id="fitting-the-models" class="level1">
<h1>Fitting the models</h1>
<p>Let’s use the following as our model</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ln_wage ~ grade + age + ttl_exp + tenure + not_smsa + south</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="xtreg-fe-fixed-effect-model-within-variance" class="level2">
<h2 class="anchored" data-anchor-id="xtreg-fe-fixed-effect-model-within-variance"><code>xtreg, fe</code>: Fixed Effect model (Within variance)</h2>
<p>The fixed effects results are</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">xtreg</span> ln_wage grade age ttl_exp tenure not_smsa south, <span class="kw">fe</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">note</span>: grade omitted because <span class="kw">of</span> collinearity.</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>Fixed-<span class="kw">effects</span> (within) regression               Number <span class="kw">of</span> <span class="kw">obs</span>     =     28,091</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>Group <span class="kw">variable</span>: idcode                          Number <span class="kw">of</span> groups  =      4,697</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>R-squared:                                      Obs per <span class="fu">group</span>:</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>     Within  = 0.1491                                         <span class="fu">min</span> =          1</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>     Between = 0.3526                                         avg =        6.0</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>     Overall = 0.2517                                         <span class="fu">max</span> =         15</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">F</span>(5, 23389)       =     819.94</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">corr</span>(u_i, Xb) = 0.2348                          Prob &gt; <span class="fu">F</span>          =     0.0000</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>     ln_wage | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>       grade |          0  (omitted)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>         age |  -.0026787    .000863    -3.10   0.002    -.0043703   -.0009871</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>     ttl_exp |   .0287709   .0014474    19.88   0.000     .0259339    .0316079</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>      tenure |   .0114355   .0009229    12.39   0.000     .0096265    .0132445</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    not_smsa |  -.0921689   .0096641    -9.54   0.000    -.1111112   -.0732266</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>       south |  -.0633396   .0110819    -5.72   0.000    -.0850608   -.0416184</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |   1.591678   .0186849    85.19   0.000     1.555054    1.628302</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>     sigma_u |  .36167618</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>     sigma_e |  .29477563</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>         rho |  .60086475   (fraction <span class="kw">of</span> <span class="kw">variance</span> due to u_i)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span> <span class="kw">test</span> that <span class="ot">all</span> u_i=0: <span class="fu">F</span>(4696, 23389) = 6.63                 Prob &gt; <span class="fu">F</span> = 0.0000</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To replicate, we’ll include <code>idcode</code> as a categorical variable. One of the benefits of <code>xtreg ..., fe</code> is efficiency; since there are over 4000 <code>idcode</code>, the regression model will fail to run. Consequently, we’ll demostrate on a subset of the data</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">preserve</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>. <span class="kw">keep</span> <span class="kw">if</span> idcode &lt; 100</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>(27,959 observations deleted)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>. <span class="kw">xtreg</span> ln_wage grade age ttl_exp tenure not_smsa south, <span class="kw">fe</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="kw">note</span>: grade omitted because <span class="kw">of</span> collinearity.</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>Fixed-<span class="kw">effects</span> (within) regression               Number <span class="kw">of</span> <span class="kw">obs</span>     =        567</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>Group <span class="kw">variable</span>: idcode                          Number <span class="kw">of</span> groups  =         89</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>R-squared:                                      Obs per <span class="fu">group</span>:</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>     Within  = 0.1895                                         <span class="fu">min</span> =          1</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>     Between = 0.2312                                         avg =        6.4</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>     Overall = 0.1900                                         <span class="fu">max</span> =         15</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">F</span>(5, 473)         =      22.12</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="fu">corr</span>(u_i, Xb) = 0.1420                          Prob &gt; <span class="fu">F</span>          =     0.0000</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>     ln_wage | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>       grade |          0  (omitted)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>         age |  -.0045718   .0054274    -0.84   0.400    -.0152366    .0060931</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>     ttl_exp |   .0313655   .0091803     3.42   0.001     .0133263    .0494046</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>      tenure |   .0149681   .0061975     2.42   0.016     .0027901    .0271462</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    not_smsa |   .0003284   .0743637     0.00   0.996    -.1457957    .1464524</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>       south |   .1353543    .170972     0.79   0.429    -.2006042    .4713129</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |   1.770705   .1125176    15.74   0.000     1.549609    1.991801</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>     sigma_u |  .35036238</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>     sigma_e |  .26779328</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>         rho |   .6312319   (fraction <span class="kw">of</span> <span class="kw">variance</span> due to u_i)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span> <span class="kw">test</span> that <span class="ot">all</span> u_i=0: <span class="fu">F</span>(88, 473) = 9.01                     Prob &gt; <span class="fu">F</span> = 0.0000</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>. <span class="kw">reg</span> ln_wage grade age ttl_exp tenure not_smsa south i.idcode, <span class="kw">noconstant</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>      Source |       SS           df       MS      Number <span class="kw">of</span> <span class="kw">obs</span>   =       567</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------   <span class="fu">F</span>(94, 473)      =    305.03</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>       Model |  2056.18728        94  21.8743328   Prob &gt; <span class="fu">F</span>        =    0.0000</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    Residual |  33.9203619       473  .071713239   R-squared       =    0.9838</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------   Adj R-squared   =    0.9805</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>       Total |  2090.10764       567  3.68625687   Root MSE        =    .26779</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>     ln_wage | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>       grade |   .1664948   .0111166    14.98   0.000     .1446507    .1883389</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>         age |  -.0045718   .0054274    -0.84   0.400    -.0152366    .0060931</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>     ttl_exp |   .0313655   .0091803     3.42   0.001     .0133263    .0494046</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>      tenure |   .0149681   .0061975     2.42   0.016     .0027901    .0271462</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    not_smsa |   .0003284   .0743637     0.00   0.996    -.1457957    .1464524</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>       south |   .1353543    .170972     0.79   0.429    -.2006042    .4713129</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>             |</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>      idcode |</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>          2  |  -.4226575   .1098026    -3.85   0.000    -.6384187   -.2068963</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>          3  |  -.5725985    .104336    -5.49   0.000    -.7776178   -.3675791</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>          4  |  -.9436944   .1389879    -6.79   0.000    -1.216805   -.6705843</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>          5  |   -.222494   .1118964    -1.99   0.047    -.4423696   -.0026184</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>          6  |  -.4007454   .1096849    -3.65   0.000    -.6162754   -.1852154</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>          7  |  -.6883352   .1225737    -5.62   0.000    -.9291914   -.4474789</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>          9  |  -.2376803   .1165492    -2.04   0.042    -.4666986    -.008662</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>         10  |  -.3435751   .1106681    -3.10   0.002    -.5610371   -.1261131</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>         12  |  -.5649688   .2342601    -2.41   0.016    -1.025288   -.1046496</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>         13  |  -.1909402   .1248158    -1.53   0.127    -.4362023    .0543219</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>         14  |   -.455463   .2143522    -2.12   0.034    -.8766633   -.0342628</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>         15  |  -.4232663   .1481695    -2.86   0.004    -.7144181   -.1321146</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>         16  |  -.5371115   .1264239    -4.25   0.000    -.7855334   -.2886895</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>         17  |  -.3603291   .1480851    -2.43   0.015    -.6513151   -.0693431</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>         18  |  -1.048504   .1680767    -6.24   0.000    -1.378773   -.7182346</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>         19  |  -.6236019    .126136    -4.94   0.000    -.8714581   -.3757457</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>         20  |  -.5473341   .1259303    -4.35   0.000    -.7947861   -.2998822</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>         21  |  -.7002773   .1569423    -4.46   0.000    -1.008668   -.3918869</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>         22  |  -.4564266    .124073    -3.68   0.000    -.7002291   -.2126242</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>         23  |  -.8079256    .166224    -4.86   0.000    -1.134554   -.4812968</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>         24  |  -.4104822   .1151672    -3.56   0.000    -.6367848   -.1841795</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>         25  |  -.3723879   .1189486    -3.13   0.002     -.606121   -.1386548</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>         26  |  -.5195303   .1469161    -3.54   0.000    -.8082192   -.2308414</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>         27  |  -.2435413    .162567    -1.50   0.135    -.5629841    .0759016</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>         29  |  -.3157487   .1642662    -1.92   0.055    -.6385305    .0070331</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>         30  |    .080972   .1171126     0.69   0.490    -.1491533    .3110972</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>         33  |  -.3586822   .2790194    -1.29   0.199    -.9069531    .1895887</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>         35  |  -.6745962    .279494    -2.41   0.016      -1.2238   -.1253927</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>         36  |  -.3269244   .1273912    -2.57   0.011    -.5772471   -.0766016</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>         37  |  -.6471198   .1735604    -3.73   0.000    -.9881646   -.3060751</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>         38  |  -.4596228   .1274658    -3.61   0.000    -.7100921   -.2091535</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>         39  |  -.4201852    .163985    -2.56   0.011    -.7424145    -.097956</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>         40  |  -.5339167   .2840895    -1.88   0.061     -1.09215    .0243168</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>         41  |  -.3757769    .122508    -3.07   0.002     -.616504   -.1350497</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>         43  |  -1.311499   .2226841    -5.89   0.000    -1.749072   -.8739265</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>         44  |  -.2583422   .1631146    -1.58   0.114     -.578861    .0621766</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>         45  |  -.1339062   .1198129    -1.12   0.264    -.3693376    .1015253</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>         46  |  -1.736985   .2252408    -7.71   0.000    -2.179582   -1.294389</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>         47  |  -.6256071   .2058861    -3.04   0.003    -1.030172   -.2210425</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>         48  |  -.9859271   .1824752    -5.40   0.000     -1.34449   -.6273647</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>         49  |  -.3247521   .1438057    -2.26   0.024     -.607329   -.0421751</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>         50  |  -.2738516   .1866851    -1.47   0.143    -.6406863    .0929831</span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>         51  |  -.6200922   .1274217    -4.87   0.000    -.8704748   -.3697096</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>         53  |  -.6259007   .1428582    -4.38   0.000     -.906616   -.3451854</span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>         54  |  -.5365555   .2812581    -1.91   0.057    -1.089225    .0161143</span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>         55  |  -.4445126   .1231406    -3.61   0.000    -.6864829   -.2025422</span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>         56  |   .3443307   .1570771     2.19   0.029     .0356754    .6529859</span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>         57  |  -.6570438    .114101    -5.76   0.000    -.8812514   -.4328363</span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>         58  |   -.435127   .1799124    -2.42   0.016    -.7886535   -.0816005</span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>         59  |   -.628225   .1364025    -4.61   0.000    -.8962548   -.3601951</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>         60  |   -.475028   .1440273    -3.30   0.001    -.7580406   -.1920155</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>         61  |  -.7261986   .1510088    -4.81   0.000     -1.02293   -.4294675</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>         62  |  -.3044535   .1221368    -2.49   0.013    -.5444515   -.0644556</span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>         63  |   .0037803   .1285151     0.03   0.977    -.2487508    .2563115</span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>         64  |  -.5483459   .1340122    -4.09   0.000    -.8116787   -.2850131</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>         65  |  -.3321434    .141554    -2.35   0.019    -.6102959    -.053991</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>         66  |  -.8689924   .1212238    -7.17   0.000    -1.107196   -.6307886</span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>         67  |  -.3807511   .1543163    -2.47   0.014    -.6839814   -.0775208</span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a>         68  |  -.6198262   .1756128    -3.53   0.000    -.9649039   -.2747485</span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>         69  |  -.4311974   .1330101    -3.24   0.001    -.6925613   -.1698336</span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>         70  |   .0557999     .23286     0.24   0.811    -.4017682    .5133679</span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>         71  |   -.541011   .1282886    -4.22   0.000    -.7930971   -.2889249</span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>         72  |  -.4935751   .1234947    -4.00   0.000    -.7362413    -.250909</span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>         73  |  -.6795435   .1474628    -4.61   0.000    -.9693067   -.3897804</span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>         75  |  -.0205057    .126925    -0.16   0.872    -.2699124     .228901</span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>         76  |  -.0420092   .2920378    -0.14   0.886    -.6158611    .5318427</span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>         77  |   -.284598   .1677175    -1.70   0.090    -.6141614    .0449655</span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>         78  |   .1533827   .1098172     1.40   0.163    -.0624072    .3691726</span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>         79  |   .4001081   .2748834     1.46   0.146    -.1400355    .9402517</span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a>         80  |   .0210369   .1955429     0.11   0.914    -.3632033     .405277</span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>         81  |  -.2832579   .2152753    -1.32   0.189    -.7062723    .1397564</span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>         82  |   .0315568   .1432313     0.22   0.826    -.2498916    .3130052</span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>         83  |  -.4661398   .1293009    -3.61   0.000     -.720215   -.2120646</span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>         84  |   .0525394   .2789779     0.19   0.851      -.49565    .6007288</span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a>         85  |    .206903   .1590657     1.30   0.194      -.10566    .5194659</span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a>         86  |  -.7807072   .1429434    -5.46   0.000     -1.06159   -.4998246</span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a>         87  |  -.5240905   .2246382    -2.33   0.020    -.9655027   -.0826783</span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a>         88  |  -.1660402   .2047806    -0.81   0.418    -.5684324    .2363519</span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>         89  |   .0577245   .2107879     0.27   0.784     -.356472    .4719209</span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>         91  |   .1126238   .2082437     0.54   0.589    -.2965734     .521821</span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>         92  |    .488832   .2785641     1.75   0.080    -.0585442    1.036208</span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a>         93  |  -.3047289   .2808968    -1.08   0.279    -.8566889    .2472311</span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a>         94  |  -.2315187   .1288964    -1.80   0.073    -.4847991    .0217617</span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a>         95  |  -.5423296   .1395023    -3.89   0.000    -.8164505   -.2682088</span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a>         96  |  -.0991001   .2025628    -0.49   0.625    -.4971343    .2989342</span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a>         97  |   .0848356   .1679777     0.51   0.614    -.2452392    .4149104</span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a>         98  |  -.0877863   .1183023    -0.74   0.458    -.3202494    .1446767</span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a>         99  |   -.127322   .1556316    -0.82   0.414    -.4331369    .1784928</span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a>. <span class="kw">restore</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>grade</code> is not estimated in the fixed effects model because it is time-invarying; within each individual it is constant. In the <code>regress</code> model, we are able to estimate it.</p>
<p><code>xtreg</code> reports 3 R-squared statistics; this is a within variance model so we can use that value (which agrees with the regression R-squared). Note that the <code>regress</code> R-squared estimate is artificially inflated due to the massive amount of predictors.</p>
</section>
<section id="xtreg-be-between-effect-model-between-variance" class="level2">
<h2 class="anchored" data-anchor-id="xtreg-be-between-effect-model-between-variance"><code>xtreg, be</code>: Between Effect model (Between variance)</h2>
<p>The between effects results are</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">xtreg</span> ln_wage grade age ttl_exp tenure not_smsa south, <span class="kw">be</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>Between regression (regression <span class="kw">on</span> <span class="fu">group</span> <span class="kw">means</span>)  Number <span class="kw">of</span> <span class="kw">obs</span>     =     28,091</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>Group <span class="kw">variable</span>: idcode                          Number <span class="kw">of</span> groups  =      4,697</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>R-squared:                                      Obs per <span class="fu">group</span>:</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>     Within  = 0.1427                                         <span class="fu">min</span> =          1</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>     Between = 0.4787                                         avg =        6.0</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>     Overall = 0.3562                                         <span class="fu">max</span> =         15</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">F</span>(6,4690)         =     717.89</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(u_i + avg(e_i.)) = .3068161                  Prob &gt; <span class="fu">F</span>          =     0.0000</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>     ln_wage | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>       grade |    .064188   .0019539    32.85   0.000     .0603575    .0680185</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>         age |  -.0041071   .0010618    -3.87   0.000    -.0061886   -.0020255</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>     ttl_exp |   .0287514    .002033    14.14   0.000     .0247658    .0327369</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>      tenure |   .0286782   .0022174    12.93   0.000      .024331    .0330254</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    not_smsa |   -.175568   .0111952   -15.68   0.000    -.1975159   -.1536202</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>       south |  -.1086271   .0098438   -11.04   0.000    -.1279256   -.0893287</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |   .8066724   .0329873    24.45   0.000     .7420017     .871343</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To replicate, collapse over <code>idcode</code> and run a regression:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">preserve</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>. <span class="kw">collapse</span> (<span class="kw">mean</span>) ln_wage grade age ttl_exp tenure not_smsa south, <span class="kw">by</span>(idcode)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>. <span class="kw">reg</span> ln_wage grade age ttl_exp tenure not_smsa south</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>      Source |       SS           df       MS      Number <span class="kw">of</span> <span class="kw">obs</span>   =     4,697</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------   <span class="fu">F</span>(6, 4690)      =    724.96</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>       Model |  406.076398         6  67.6793996   Prob &gt; <span class="fu">F</span>        =    0.0000</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    Residual |  437.838178     4,690  .093355688   R-squared       =    0.4812</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------   Adj R-squared   =    0.4805</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>       Total |  843.914575     4,696  .179709237   Root MSE        =    .30554</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>     ln_wage | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>       grade |   .0642015   .0019467    32.98   0.000     .0603849     .068018</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>         age |  -.0039009   .0010611    -3.68   0.000    -.0059812   -.0018206</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>     ttl_exp |   .0285569   .0020267    14.09   0.000     .0245836    .0325301</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>      tenure |   .0288392   .0022077    13.06   0.000      .024511    .0331673</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    not_smsa |  -.1758847   .0111494   -15.78   0.000    -.1977428   -.1540266</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>       south |  -.1080377   .0098055   -11.02   0.000    -.1272611   -.0888142</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |   .8000955   .0328792    24.33   0.000     .7356368    .8645542</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>. <span class="kw">restore</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Again, the coefficients agree to three decimals and the between R-square agrees.</p>
<p>All predictors here are estimated; if we had any time-variant by individual-invariant predictors (e.g.&nbsp;time), they would not be estimable here.</p>
</section>
<section id="xtreg-re-random-effect-model-both-variances" class="level2">
<h2 class="anchored" data-anchor-id="xtreg-re-random-effect-model-both-variances"><code>xtreg, re</code>: Random Effect model (Both variances)</h2>
<p>The random effects results are</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">xtreg</span> ln_wage grade age ttl_exp tenure not_smsa south, re</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>Random-<span class="kw">effects</span> GLS regression                   Number <span class="kw">of</span> <span class="kw">obs</span>     =     28,091</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>Group <span class="kw">variable</span>: idcode                          Number <span class="kw">of</span> groups  =      4,697</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>R-squared:                                      Obs per <span class="fu">group</span>:</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>     Within  = 0.1483                                         <span class="fu">min</span> =          1</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>     Between = 0.4701                                         avg =        6.0</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>     Overall = 0.3569                                         <span class="fu">max</span> =         15</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                                                Wald <span class="fu">chi2</span>(6)      =    8304.62</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">corr</span>(u_i, X) = 0 (assumed)                      Prob &gt; <span class="fu">chi2</span>       =     0.0000</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>     ln_wage | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>       grade |   .0691836   .0017689    39.11   0.000     .0657166    .0726506</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>         age |  -.0038386   .0006544    -5.87   0.000    -.0051212   -.0025559</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>     ttl_exp |   .0301313   .0011215    26.87   0.000     .0279331    .0323294</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>      tenure |   .0134656   .0008442    15.95   0.000      .011811    .0151202</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    not_smsa |   -.128591   .0072246   -17.80   0.000     -.142751    -.114431</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>       south |  -.0932646    .007231   -12.90   0.000     -.107437   -.0790921</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |   .7544109   .0273445    27.59   0.000     .7008168    .8080051</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>     sigma_u |  .26027808</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>     sigma_e |  .29477563</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>         rho |  .43808743   (fraction <span class="kw">of</span> <span class="kw">variance</span> due to u_i)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Just fit a regular mixed model:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>. mixed ln_wage grade age ttl_exp tenure not_smsa south || idcode:</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>Performing EM optimization ...</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>Performing <span class="kw">gradient</span>-based optimization: </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>Iteration 0:  Log likelihood = -9218.9773  </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>Iteration 1:  Log likelihood = -9218.9773  </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>Computing standard errors ...</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>Mixed-<span class="kw">effects</span> ML regression                         Number <span class="kw">of</span> <span class="kw">obs</span>    =  28,091</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>Group <span class="kw">variable</span>: idcode                              Number <span class="kw">of</span> groups =   4,697</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                                                    Obs per <span class="fu">group</span>:</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">min</span> =       1</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                                                                 avg =     6.0</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">max</span> =      15</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                                                    Wald <span class="fu">chi2</span>(6)     = 8496.81</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>Log likelihood = -9218.9773                         Prob &gt; <span class="fu">chi2</span>      =  0.0000</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>     ln_wage | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>       grade |   .0691186   .0017231    40.11   0.000     .0657414    .0724959</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>         age |   -.003869   .0006491    -5.96   0.000    -.0051411   -.0025969</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>     ttl_exp |    .030151   .0011135    27.08   0.000     .0279687    .0323334</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>      tenure |    .013591   .0008441    16.10   0.000     .0119365    .0152454</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    not_smsa |  -.1299789    .007154   -18.17   0.000    -.1440004   -.1159575</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>       south |  -.0941264   .0071291   -13.20   0.000    -.1080991   -.0801537</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |   .7566548   .0267655    28.27   0.000     .7041954    .8091142</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  Random-<span class="kw">effects</span> parameters  |   Estimate   Std. err.     [95% conf. interval]</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>-----------------------------+------------------------------------------------</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>idcode: Identity             |</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>                  <span class="kw">var</span>(<span class="dt">_cons</span>) |   .0626522   .0017678      .0592815    .0662147</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>-----------------------------+------------------------------------------------</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>               <span class="kw">var</span>(Residual) |    .087569    .000811      .0859938    .0891732</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>LR <span class="kw">test</span> vs. linear <span class="kw">model</span>: chibar2(01) = 7277.75       Prob &gt;= chibar2 = 0.0000</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The results are very close; we can get even closer by fitting the <code>xtreg</code> model with the <code>mle</code> option, which uses a different estimation strategy.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">xtreg</span> ln_wage grade age ttl_exp tenure not_smsa south, re <span class="kw">mle</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>Fitting constant-only <span class="kw">model</span>:</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>Iteration 0:  Log likelihood = -12663.954</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>Iteration 1:  Log likelihood = -12649.756</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>Iteration 2:  Log likelihood = -12649.614</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>Iteration 3:  Log likelihood = -12649.614</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>Fitting full <span class="kw">model</span>:</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>Iteration 0:  Log likelihood = -9271.8615</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>Iteration 1:  Log likelihood = -9219.1214</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>Iteration 2:  Log likelihood = -9218.9773</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>Iteration 3:  Log likelihood = -9218.9773</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>Random-<span class="kw">effects</span> ML regression                        Number <span class="kw">of</span> <span class="kw">obs</span>    =  28,091</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>Group <span class="kw">variable</span>: idcode                              Number <span class="kw">of</span> groups =   4,697</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>Random <span class="kw">effects</span> u_i ~ Gaussian                       Obs per <span class="fu">group</span>:</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">min</span> =       1</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>                                                                 avg =     6.0</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="fu">max</span> =      15</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>                                                    LR <span class="fu">chi2</span>(6)       = 6861.27</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>Log likelihood = -9218.9773                         Prob &gt; <span class="fu">chi2</span>      =  0.0000</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>     ln_wage | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>       grade |   .0691186   .0017233    40.11   0.000     .0657411    .0724962</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>         age |   -.003869   .0006491    -5.96   0.000    -.0051413   -.0025967</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>     ttl_exp |    .030151   .0011135    27.08   0.000     .0279687    .0323334</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>      tenure |    .013591   .0008454    16.08   0.000     .0119341    .0152478</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    not_smsa |  -.1299789   .0071711   -18.13   0.000     -.144034   -.1159239</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>       south |  -.0941264   .0071356   -13.19   0.000    -.1081119   -.0801409</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |   .7566548   .0267773    28.26   0.000     .7041722    .8091374</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    /sigma_u |   .2503043   .0035313                      .2434779    .2573221</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    /sigma_e |   .2959207   .0013704                       .293247    .2986188</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>         rho |   .4170663   .0074745                      .4024774    .4317704</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>LR <span class="kw">test</span> <span class="kw">of</span> sigma_u=0: chibar2(01) = 7277.75            Prob &gt;= chibar2 = 0.000</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>